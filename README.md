# Конфигурационное управление. Домашнее задание. Вариант 2

# Конвертер учебного конфигурационного языка в YAML

## Общее описание

Разработан инструмент командной строки, который преобразует текст из входного формата в выходной формат YAML. Инструмент выявляет синтаксические ошибки с выдачей понятных сообщений.

Входной текст принимается из файла, путь к которому задан ключом командной строки. Выходной текст на языке YAML может быть направлен как в файл, так и в стандартный вывод.

### Ключевые возможности:
- **Поддержка полного синтаксиса**: числа, массивы, константы, комментарии
- **Валидация синтаксиса**: Детальные сообщения об ошибках
- **Рекурсивный парсинг**: Поддержка вложенных конструкций
- **Гибкий вывод**: В файл или стандартный вывод

## Архитектура и модули

### Основные модули

#### 1. Модуль парсинга (Parsing Module)
**Назначение**: Разбор входного текста на токены и построение AST.

**Реализованные функции**:
- Лексический анализ (разбиение на токены)
- Синтаксический анализ (проверка грамматики)
- Семантический анализ (проверка констант, типов)
- Рекурсивный парсинг вложенных конструкций

**Ключевые классы и методы**:
- `ConfigParser.remove_comments()` - удаление комментариев
- `ConfigParser.parse_value()` - парсинг значений
- `ConfigParser.parse_array()` - парсинг массивов
- `ConfigParser.process_definitions()` - обработка констант

#### 2. Модуль преобразования (Transformation Module)
**Назначение**: Преобразование AST в структуры данных Python.

**Реализованные функции**:
- Преобразование чисел (целые, вещественные)
- Преобразование массивов (включая вложенные)
- Подстановка значений констант
- Построение словарей Python

#### 3. Модуль сериализации (Serialization Module)
**Назначение**: Сериализация структур данных в формат YAML.

**Реализованные функции**:
- Преобразование в формат YAML
- Форматирование вывода (отступы, переносы строк)
- Поддержка Unicode
- Запись в файл или стандартный вывод

#### 4. Модуль обработки ошибок (Error Handling Module)
**Назначение**: Обнаружение и обработка синтаксических ошибок.

**Реализованные функции**:
- Проверка формата чисел
- Проверка объявления констант
- Проверка использования необъявленных констант
- Проверка корректности массивов
- Проверка синтаксиса присваиваний

## Синтаксис учебного конфигурационного языка

### 1. Числа 
[+-]?([1-9][0-9]*|0)
**Примеры**:
- `8080`
- `-25.5`
- `+3.14`
- `0`

### 2. Массивы 
array( значение, значение, значение, ... )
**Примеры**:
- `array(1, 2, 3)`
- `array(red, green, blue)`
- `array(array(1, 2), array(3, 4))`

### 3. Имена переменных 
[a-z][a-z0-9_]*
**Примеры**:
- `server_name`
- `port_number`
- `max_connections`

### 4. Константы (определение) 
(def имя значение);
**Примеры**:
- `(def max_users 100);`
- `(def colors array(red, green, blue));`

### 5. Константы (использование)
{имя}
**Примеры**:
- `{max_users}`
- `{colors}`

### 6. Присваивания
имя = значение;
**Примеры**:
- `port = 8080;`
- `features = array(auth, logging);`

### 7. Комментарии
Однострочные:
C Это однострочный комментарий
Многострочные:
--[[
Это многострочный
комментарий
]]

## Конфигурация и параметры

### Параметры командной строки

#### Обязательные параметры:
| Параметр | Короткая форма | Тип | Описание | Пример | Валидация |
|----------|----------------|-----|----------|--------|-----------|
| `--input` | `-i` | Строка | Путь к входному файлу | `server.config` | Файл должен существовать, иметь расширение .config |

#### Опциональные параметры:
| Параметр | Короткая форма | Тип | Описание | Значение по умолчанию | Валидация |
|----------|----------------|-----|----------|----------------------|-----------|
| `--output` | `-o` | Строка | Путь к выходному файлу YAML | Стандартный вывод | Корректное расширение .yaml или .yml |
| `--help` | `-h` | Флаг | Вывод справки | Нет | - |

### Форматы файлов

#### Входной файл (.config)
C Пример конфигурации
(def max_users 100);
(def colors array(red, green, blue));

server_name = "api-server";
port = {max_users};
enabled_features = {colors};

#### Выходной файл (.yaml)
```yaml
server_name: api-server
port: 100
enabled_features:
  - red
  - green
  - blue
```
### Примеры использования

#### Пример 1: Веб-сервер
**Входной файл (webserver.config):**
C Конфигурация веб-сервера
(def max_workers 4);
(def default_ports array(80, 443, 8080));

server_name = "my_web_server";
port = 8080;
workers = {max_workers};
allowed_ports = {default_ports};

**Команда:**
```bash
python config_converter.py -i webserver.config
```
**Результат**
```
server_name: my_web_server
port: 8080
workers: 4
allowed_ports:
  - 80
  - 443
  - 8080
```
## Тесты
**Тест 1***
Вывод веб-сервера в консоль
```
python config_converter.py -i webserver.config
```
**Тест 2***
Сохранение веб-сервера в файл
```
python config_converter.py -i webserver.config -o test.yaml
```
Должен создаться файл test.yaml
**Тест 3***
Проверка созданного файла
```
type test.yaml
```
**Тест 4***
Игра
```
python config_converter.py -i game.config
```
**Тест 5***
Обработка ошибок
```
python config_converter.py -i несуществующий.config
```
**Тест 6***
Запуск тестов
```
python -m unittest test_config_converter.py
```


